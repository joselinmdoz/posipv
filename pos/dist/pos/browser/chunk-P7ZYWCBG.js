import{a as I}from"./chunk-P5KSWAQ2.js";import{e as O}from"./chunk-EKOQI3CN.js";import{a as E}from"./chunk-OGHJEGVW.js";import{a as N,b as V,c as T,d as F,e as A,j as W}from"./chunk-5CMZHIZT.js";import"./chunk-XZ3PRBQD.js";import{Aa as w,Ea as C,Ka as b,La as n,Ma as t,N as x,Oa as S,Pa as v,Qa as p,S as c,T as u,Ya as a,ab as h,ba as g,bb as M,cb as y,j as f,pa as l,v as _,wb as D,xb as k,zb as P}from"./chunk-EVJ26B7U.js";function j(d,o){d&1&&(n(0,"div",2),a(1,"Backend pendiente: "),n(2,"code"),a(3,"/api/settings/denominations"),t()())}function z(d,o){if(d&1){let e=S();n(0,"div",14)(1,"div")(2,"input",15),y("ngModelChange",function(r){let s=c(e).index,m=p();return M(m.denoms()[s].value,r)||(m.denoms()[s].value=r),u(r)}),t()(),n(3,"div",11)(4,"input",16),y("ngModelChange",function(r){let s=c(e).index,m=p();return M(m.denoms()[s].enabled,r)||(m.denoms()[s].enabled=r),u(r)}),t()(),n(5,"div",11)(6,"button",17),v("click",function(){let r=c(e).index,s=p();return u(s.remove(r))}),a(7,"Eliminar"),t()()()}if(d&2){let e=o.index,i=p();l(2),h("ngModel",i.denoms()[e].value),l(2),h("ngModel",i.denoms()[e].enabled)}}var L=class d{api=x(I);toast=x(E);denoms=g([]);busy=g(!1);error=g(null);constructor(){this.api.listDenominations().pipe(_(()=>(this.error.set("denoms_failed"),f([{value:1,enabled:!0},{value:5,enabled:!0},{value:10,enabled:!0},{value:20,enabled:!0},{value:50,enabled:!0},{value:100,enabled:!0}])))).subscribe(o=>this.denoms.set(o))}add(){this.denoms.update(o=>[...o,{value:0,enabled:!0}])}remove(o){this.denoms.update(e=>e.filter((i,r)=>r!==o))}save(){this.busy.set(!0);let o=this.denoms().filter(e=>isFinite(Number(e.value))).map(e=>({value:Number(e.value),enabled:!!e.enabled})).sort((e,i)=>e.value-i.value);this.api.saveDenominations(o).pipe(_(()=>(this.toast.push({kind:"error",title:"No se pudo guardar",message:"Verifica /api/settings/denominations"}),f(null)))).subscribe(()=>{this.toast.push({kind:"success",title:"Guardado",message:"Denominaciones actualizadas"}),this.busy.set(!1),this.denoms.set(o)})}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=w({type:d,selectors:[["ng-component"]],decls:27,vars:3,consts:[[1,"page"],[1,"page-head"],[1,"muted"],[1,"actions"],["routerLink","/settings",1,"btn"],[1,"btn","primary",3,"click"],[1,"btn","primary",3,"click","disabled"],[1,"card"],["class","muted",4,"ngIf"],[1,"table"],[1,"th"],[1,"r"],["class","tr",4,"ngFor","ngForOf"],[1,"note","mt"],[1,"tr"],["type","number","step","0.01",3,"ngModelChange","ngModel"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"link",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h1"),a(4,"Denominaciones"),t(),n(5,"p",2),a(6,"Plantilla para conteo r\xE1pido en el cierre de caja."),t()(),n(7,"div",3)(8,"a",4),a(9,"Volver"),t(),n(10,"button",5),v("click",function(){return i.add()}),a(11,"A\xF1adir"),t(),n(12,"button",6),v("click",function(){return i.save()}),a(13,"Guardar"),t()()(),n(14,"div",7),C(15,j,4,0,"div",8),n(16,"div",9)(17,"div",10)(18,"div"),a(19,"Valor"),t(),n(20,"div",11),a(21,"Activo"),t(),n(22,"div",11),a(23,"Acciones"),t()(),C(24,z,8,2,"div",12),t(),n(25,"div",13),a(26," Mant\xE9n denominaciones realistas. Si no existe el billete\u2026 no lo inventes: eso es contabilidad creativa, no contabilidad. "),t()()()),e&2&&(l(12),b("disabled",i.busy()),l(3),b("ngIf",i.error()),l(9),b("ngForOf",i.denoms()))},dependencies:[P,D,k,W,V,A,N,T,F,O],styles:[".page[_ngcontent-%COMP%]{padding:18px}.page-head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:16px;align-items:flex-end;flex-wrap:wrap}h1[_ngcontent-%COMP%]{margin:0;font-size:22px;letter-spacing:-.02em}.muted[_ngcontent-%COMP%]{color:var(--muted)}.actions[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.btn[_ngcontent-%COMP%]{padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#fff;cursor:pointer;text-decoration:none}.btn.primary[_ngcontent-%COMP%]{background:var(--brand);color:#fff;border-color:transparent}.card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--border);border-radius:16px;padding:14px;box-shadow:var(--shadow-sm);margin-top:12px}.table[_ngcontent-%COMP%]{margin-top:10px;border:1px solid var(--border);border-radius:14px;overflow:hidden}.th[_ngcontent-%COMP%], .tr[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr .6fr .6fr;gap:10px;padding:10px 12px;align-items:center}.th[_ngcontent-%COMP%]{background:#fafafa;font-size:12px;color:var(--muted);font-weight:700}.tr[_ngcontent-%COMP%]{border-top:1px solid var(--border)}.r[_ngcontent-%COMP%]{text-align:right}input[_ngcontent-%COMP%]{width:100%;padding:10px;border-radius:12px;border:1px solid var(--border);outline:none}.link[_ngcontent-%COMP%]{border:none;background:transparent;color:var(--brand);cursor:pointer;font-weight:700}.mt[_ngcontent-%COMP%]{margin-top:12px}.note[_ngcontent-%COMP%]{padding:12px;border-radius:14px;border:1px dashed var(--border);color:var(--muted)}"]})};export{L as DenominationsComponent};
